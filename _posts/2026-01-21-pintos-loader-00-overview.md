---
layout: post
title: "Pintos Loader.S 详解（零）：系列概述"
date: 2026-01-21
categories: [技术, Pintos]
tags: [OS, Pintos, 汇编, 引导加载程序]
description: "Pintos 操作系统引导加载程序 loader.S 的详细分析文档系列概述，包括文档列表、阅读顺序和先决知识。"
---

## 概述

这是一个针对 Pintos 操作系统引导加载程序 `loader.S` 的详细分析文档系列，力求用简单易懂的方式解释每一个概念和代码片段。

---

## 文档列表

| 序号 | 主题 | 简介 |
|------|------|------|
| 1 | 初始化 | 段寄存器和栈的设置 |
| 2 | 串口配置 | 配置串口用于调试输出 |
| 3 | 扫描分区 | 扫描硬盘寻找 Pintos 内核分区 |
| 4 | 加载内核 | 将内核从磁盘读取到内存 |
| 5 | 跳转到内核 | 从 ELF 头读取入口地址并跳转 |
| 6 | 错误处理 | 处理各种启动失败情况 |
| 7 | puts 函数 | 巧妙的字符串打印实现 |
| 8 | putc 函数 | 字符输出和自修改代码 |
| 9 | read_sector 函数 | 使用 BIOS 扩展读取磁盘 |
| 10 | 数据结构 | 引导扇区末尾的数据定义 |

---

## 阅读顺序

建议按照文档编号顺序阅读，因为：
1. 文档按代码执行顺序组织
2. 后面的文档可能引用前面介绍的概念
3. 辅助函数的文档放在最后，因为它们被多处调用

---

## 每个文档的结构

每个文档都包含以下部分：

- **概述**：本部分代码的作用
- **原始代码**：完整的汇编代码
- **前置知识**：理解代码所需的背景知识
- **逐行详解**：每一行代码的详细解释
- **图解/流程图**：可视化的执行过程
- **常见问题**：FAQ 解答常见疑惑
- **练习思考**：帮助加深理解的思考题

---

## 先决知识

阅读这些文档前，最好了解：

### 基本编程概念
- 变量、函数、循环、条件判断
- 十六进制数表示

### 计算机基础
- 内存的概念
- CPU 执行指令的基本原理
- 二进制和十六进制

### 可选但有帮助
- 任意一种汇编语言的基础
- C 语言基础

---

## 术语表

| 术语 | 解释 |
|------|------|
| BIOS | 基本输入输出系统，提供底层硬件服务 |
| MBR | 主引导记录，硬盘第一个扇区 |
| 实模式 | x86 CPU 启动时的 16 位模式 |
| 保护模式 | x86 CPU 的 32 位模式 |
| 段寄存器 | 用于内存分段的特殊寄存器 |
| LBA | 逻辑块寻址，现代磁盘寻址方式 |
| ELF | 可执行文件格式 |
| 中断 | CPU 响应外部事件或软件请求的机制 |

---

## 相关文件

- `src/threads/loader.S` - 引导加载程序源代码
- `src/threads/loader.h` - 相关常量定义
- `src/threads/start.S` - 内核入口点（loader 跳转的目标）

---

## 学习建议

1. **边读边画**：画出内存布局和执行流程图
2. **动手实验**：用调试器单步执行代码
3. **修改代码**：尝试做小修改看看效果
4. **提出问题**：不懂就问，记下疑惑

---

## 参考资料

- [Intel x86 手册](https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html)
- [OSDev Wiki](https://wiki.osdev.org/)
- [Pintos 官方文档](https://web.stanford.edu/class/cs140/projects/pintos/pintos.html)
- [BIOS 中断列表](http://www.ctyme.com/intr/int.htm)

---

祝学习愉快！
